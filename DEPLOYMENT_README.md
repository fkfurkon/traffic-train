# ЁЯЪЧ Traffic Forecasting System
# р╕гр╕░р╕Ър╕Ър╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣Мр╕Бр╕▓р╕гр╕Ир╕гр╕▓р╕Ир╕г

р╣Вр╕Ыр╕гр╣Ар╕Ир╕Бр╕Хр╣Мр╕Щр╕╡р╣Йр╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Юр╕Вр╕нр╕Зр╣Вр╕бр╣Ар╕Фр╕ер╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣Мр╕Бр╕▓р╕гр╕Ир╕гр╕▓р╕Ир╕г 3 р╣Бр╕Ър╕Ъ р╣Бр╕ер╕░р╣Гр╕лр╣Йр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Щр╕│р╣Др╕Ыр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З

## ЁЯУЛ р╣Вр╕бр╣Ар╕Фр╕ер╕Чр╕╡р╣Ир╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ъ

1. **XGBoost** - Gradient Boosting Model
   - тЬЕ р╣Ар╕гр╣Зр╕з р╣Бр╕ер╕░р╣Гр╕Кр╣Йр╕Чр╕гр╕▒р╕Юр╕вр╕▓р╕Бр╕гр╕Щр╣Йр╕нр╕в
   - тЬЕ р╕Хр╕╡р╕Др╕зр╕▓р╕бр╕Ьр╕ер╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕в (Feature Importance)
   - тЬЕ р╣Ар╕лр╕бр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ъ Real-time prediction

2. **SARIMA** - Seasonal Autoregressive Integrated Moving Average
   - тЬЕ р╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Хр╕▓р╕бр╕др╕Фр╕╣р╕Бр╕▓р╕ер╣Др╕Фр╣Йр╕Фр╕╡
   - тЬЕ р╣Ар╕лр╕бр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Бр╕Щр╕зр╣Вр╕Щр╣Йр╕б
   - тЪая╕П р╣Гр╕Кр╣Йр╣Ар╕зр╕ер╕▓р╣Гр╕Щр╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╕бр╕▓р╕Б

3. **LSTM** - Long Short-Term Memory Neural Network
   - тЬЕ р╕Ир╕▒р╕Ър╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Лр╕▒р╕Ър╕Лр╣Йр╕нр╕Щр╣Др╕Фр╣Йр╕Фр╕╡
   - тЬЕ р╣Ар╕лр╕бр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕зр╕▓р╕бр╕кр╕▒р╕бр╕Юр╕▒р╕Щр╕Шр╣Мр╕гр╕░р╕вр╕░р╕вр╕▓р╕з
   - тЪая╕П р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕бр╕▓р╕Б р╣Бр╕ер╕░р╣Гр╕Кр╣Йр╣Ар╕зр╕ер╕▓р╕Эр╕╢р╕Бр╕Щр╕▓р╕Щ

## ЁЯЧВя╕П р╣Др╕Яр╕ер╣Мр╣Гр╕Щр╣Вр╕Ыр╕гр╣Ар╕Ир╕Бр╕Хр╣М

```
ЁЯУБ Traffic Forecasting Project/
тФЬтФАтФА ЁЯУК traffic_dataset1.csv                    # р╕Вр╣Йр╕нр╕бр╕╣р╕е traffic
тФЬтФАтФА ЁЯУУ traffic_forecasting_comparison.ipynb    # р╣Вр╕Щр╣Йр╕Хр╕Ър╕╕р╣Кр╕Бр╕лр╕ер╕▒р╕Б
тФЬтФАтФА ЁЯФз model_deployment_guide.py               # р╕Др╕ер╕▓р╕кр╕кр╕│р╕лр╕гр╕▒р╕Ър╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Вр╕бр╣Ар╕Фр╕е
тФЬтФАтФА ЁЯМР traffic_api.py                         # Flask API
тФЬтФАтФА ЁЯТ╛ save_models.py                         # р╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕е
тФЬтФАтФА ЁЯУЭ usage_example.py                       # р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
тФЬтФАтФА ЁЯУж requirements_deployment.txt            # р╣Др╕ер╕Ър╕гр╕▓р╕гр╕╡р╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ
тФЬтФАтФА ЁЯУЛ requirements.txt                       # р╣Др╕ер╕Ър╕гр╕▓р╕гр╕╡р╕кр╕│р╕лр╕гр╕▒р╕Ъ notebook
тФФтФАтФА ЁЯУБ models/                               # р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Вр╕бр╣Ар╕Фр╕ер╕Чр╕╡р╣Ир╕Ър╕▒р╕Щр╕Чр╕╢р╕Б
    тФЬтФАтФА xgb_model.pkl
    тФЬтФАтФА lstm_model.h5
    тФЬтФАтФА scaler.pkl
    тФЬтФАтФА feature_columns.pkl
    тФЬтФАтФА sarima_model.pkl (optional)
    тФФтФАтФА metadata.json
```

## ЁЯЪА р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### 1. р╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕е
```bash
# р╕гр╕▒р╕Щ Jupyter notebook
jupyter notebook traffic_forecasting_comparison.ipynb

# р╕лр╕гр╕╖р╕нр╣Гр╕Кр╣Й VS Code notebook extension
```

### 2. р╕Бр╕▓р╕гр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕е
р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕ер╣Гр╕Щр╣Вр╕Щр╣Йр╕Хр╕Ър╕╕р╣Кр╕Бр╣Бр╕ер╣Йр╕з р╕гр╕▒р╕Щ cell р╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕вр╣Ар╕Юр╕╖р╣Ир╕нр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕е р╕лр╕гр╕╖р╕нр╣Гр╕Кр╣Й:
```python
from save_models import save_trained_models
save_trained_models(xgb_model, lstm_model, scaler, feature_cols)
```

### 3. р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Бр╕Ър╕Ър╕Зр╣Ир╕▓р╕в
```bash
python usage_example.py
```

### 4. р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ьр╣Ир╕▓р╕Щ API
```bash
# р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Др╕ер╕Ър╕гр╕▓р╕гр╕╡р╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ
pip install -r requirements_deployment.txt

# р╕гр╕▒р╕Щ API server
python traffic_api.py

# р╕Чр╕Фр╕кр╕нр╕Ъ API
curl -X POST http://localhost:5000/predict \
  -H "Content-Type: application/json" \
  -d '{
    "current_vehicle_count": 45,
    "historical_data": [40, 42, 44, 43, 45],
    "timestamp": "2025-09-10T14:30:00"
  }'
```

### 5. р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Гр╕Щр╣Вр╕Др╣Йр╕Ф
```python
from model_deployment_guide import create_prediction_pipeline
from datetime import datetime

# р╕кр╕гр╣Йр╕▓р╕Зр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣М
predict_func = create_prediction_pipeline()

# р╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣М
result = predict_func(
    datetime.now(), 
    45,  # р╕Ир╕│р╕Щр╕зр╕Щр╕гр╕Цр╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ
    [40, 42, 44, 43, 45]  # р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕вр╣Йр╕нр╕Щр╕лр╕ер╕▒р╕З
)

print(f"р╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣М: {result['ensemble_prediction']:.1f} р╕Др╕▒р╕Щ")
```

## ЁЯУК API Endpoints

### POST /predict
р╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣Мр╕Бр╕▓р╕гр╕Ир╕гр╕▓р╕Ир╕гр╕Ир╕╕р╕Фр╣Ар╕Фр╕╡р╕вр╕з

**Request:**
```json
{
  "current_vehicle_count": 45,
  "historical_data": [40, 42, 44, 43, 45],
  "timestamp": "2025-09-10T14:30:00"
}
```

**Response:**
```json
{
  "success": true,
  "prediction": {
    "ensemble_prediction": 47.5,
    "individual_predictions": {
      "XGBoost": 46.2,
      "LSTM": 48.8
    },
    "confidence": "high"
  },
  "input": {
    "current_time": "2025-09-10T14:30:00",
    "target_time": "2025-09-10T15:30:00",
    "current_vehicle_count": 45
  }
}
```

### POST /batch_predict
р╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣Мр╕Бр╕▓р╕гр╕Ир╕гр╕▓р╕Ир╕гр╕лр╕ер╕▓р╕вр╕Ир╕╕р╕Ф

### GET /status
р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╣Вр╕бр╣Ар╕Фр╕е

### GET /health
Health check

## ЁЯФз р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕З

### р╕Ыр╕гр╕▒р╕Ър╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Вр╕бр╣Ар╕Фр╕е
```python
# р╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Б predict_ensemble
result = system.predict_ensemble(
    timestamp=datetime.now(),
    vehicle_count=45,
    sequence_data=historical_data,
    weights=[0.7, 0.3]  # XGBoost 70%, LSTM 30%
)
```

### р╣Ар╕Юр╕┤р╣Ир╕бр╣Вр╕бр╣Ар╕Фр╕ер╣Гр╕лр╕бр╣И
1. р╣Ар╕Юр╕┤р╣Ир╕бр╣Вр╕бр╣Ар╕Фр╕ер╣Гр╕Щ `TrafficForecastingSystem` class
2. р╣Ар╕Юр╕┤р╣Ир╕бр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ predict р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Вр╕бр╣Ар╕Фр╕ер╣Гр╕лр╕бр╣И
3. р╕нр╕▒р╕Юр╣Ар╕Фр╕Х `predict_ensemble` method

## ЁЯУИ р╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Юр╣Вр╕бр╣Ар╕Фр╕е

| р╣Вр╕бр╣Ар╕Фр╕е | RMSE | MAE | R┬▓ | р╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕з | р╕Чр╕гр╕▒р╕Юр╕вр╕▓р╕Бр╕г |
|-------|------|-----|----|---------|---------| 
| XGBoost | ЁЯЯв р╕Хр╣Ир╕│ | ЁЯЯв р╕Хр╣Ир╕│ | ЁЯЯв р╕кр╕╣р╕З | ЁЯЯв р╣Ар╕гр╣Зр╕з | ЁЯЯв р╕Щр╣Йр╕нр╕в |
| SARIMA | ЁЯЯб р╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З | ЁЯЯб р╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З | ЁЯЯб р╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З | ЁЯФ┤ р╕Кр╣Йр╕▓ | ЁЯЯб р╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З |
| LSTM | ЁЯЯв р╕Хр╣Ир╕│ | ЁЯЯв р╕Хр╣Ир╕│ | ЁЯЯв р╕кр╕╣р╕З | ЁЯФ┤ р╕Кр╣Йр╕▓ | ЁЯФ┤ р╕бр╕▓р╕Б |

*р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕нр╕▓р╕Ир╣Бр╕Хр╕Бр╕Хр╣Ир╕▓р╕Зр╕Бр╕▒р╕Щр╕Вр╕╢р╣Йр╕Щр╕нр╕вр╕╣р╣Ир╕Бр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е*

## ЁЯОп р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### р╕кр╕│р╕лр╕гр╕▒р╕Ъ Real-time Application
- р╣Гр╕Кр╣Й **XGBoost** р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕з
- р╣Гр╕Кр╣Й **Ensemble** р╕Цр╣Йр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Др╕зр╕▓р╕бр╣Бр╕бр╣Ир╕Щр╕вр╕│р╕кр╕╣р╕З

### р╕кр╕│р╕лр╕гр╕▒р╕Ъ Batch Processing
- р╣Гр╕Кр╣Й **LSTM** р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕зр╕▓р╕бр╣Бр╕бр╣Ир╕Щр╕вр╕│р╕кр╕╣р╕Зр╕кр╕╕р╕Ф
- р╣Гр╕Кр╣Й **SARIMA** р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Бр╕Щр╕зр╣Вр╕Щр╣Йр╕б

### р╕кр╕│р╕лр╕гр╕▒р╕Ъ Mobile/Edge Device
- р╣Гр╕Кр╣Й **XGBoost** р╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ
- р╕ер╕Фр╕Ир╕│р╕Щр╕зр╕Щ features р╕Цр╣Йр╕▓р╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ

## ЁЯРЫ р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╕Ыр╕▒р╕Нр╕лр╕▓

### р╣Вр╕бр╣Ар╕Фр╕ер╣Вр╕лр╕ер╕Фр╣Др╕бр╣Ир╣Др╕Фр╣Й
```bash
# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Др╕Яр╕ер╣Мр╣Вр╕бр╣Ар╕Фр╕е
ls -la models/

# р╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕ер╣Гр╕лр╕бр╣И
jupyter notebook traffic_forecasting_comparison.ipynb
```

### API р╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ
```bash
# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ dependencies
pip install -r requirements_deployment.txt

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ port
netstat -an | grep 5000
```

### р╕Бр╕▓р╕гр╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣Мр╣Др╕бр╣Ир╣Бр╕бр╣Ир╕Щр╕вр╕│
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕╕р╕Ур╕ар╕▓р╕Юр╕Вр╣Йр╕нр╕бр╕╣р╕е input
- р╣Ар╕Юр╕┤р╣Ир╕бр╕Вр╣Йр╕нр╕бр╕╣р╕е historical_data
- р╕Ыр╕гр╕▒р╕Ъ weights р╣Гр╕Щр╕Бр╕▓р╕гр╕гр╕зр╕бр╣Вр╕бр╣Ар╕Фр╕е

## ЁЯУЮ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╣Ир╕н

р╕лр╕▓р╕Бр╕бр╕╡р╕Др╕│р╕Цр╕▓р╕бр╕лр╕гр╕╖р╕нр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Др╕зр╕▓р╕бр╕Кр╣Ир╕зр╕вр╣Ар╕лр╕ер╕╖р╕н р╕кр╕▓р╕бр╕▓р╕гр╕Ц:
- р╣Ар╕Ыр╕┤р╕Ф Issue р╣Гр╕Щ GitHub repository
- р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Ьр╕╣р╣Йр╕Юр╕▒р╕Тр╕Щр╕▓

## ЁЯУД License

MIT License - р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╕нр╕вр╣Ир╕▓р╕Зр╕нр╕┤р╕кр╕гр╕░

---

### ЁЯФД р╕нр╕▒р╕Юр╣Ар╕Фр╕Чр╕ер╣Ир╕▓р╕кр╕╕р╕Ф
- р╣Ар╕Юр╕┤р╣Ир╕б API endpoint р╕кр╕│р╕лр╕гр╕▒р╕Ъ batch prediction
- р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф
- р╣Ар╕Юр╕┤р╣Ир╕бр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З

**Happy Traffic Forecasting! ЁЯЪЧЁЯУК**
